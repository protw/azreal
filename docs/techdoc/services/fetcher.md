
**Fetcher** - сервіс для збирання даних з API [Airly](https://developer.airly.org/docs) і запису у власну базу даних

### **Збір даних**

Збір даних відбувається з API Airly за посланням:
```
https://airapi.airly.eu/
```
Кількість запитів на день обмежені, в кількості 100 запитів на день. Перш за все, під час створення запиту, в заголовку (headers) потрібно передати ключ `token` Airly.

Отримання даних використовується за допомогою `GET` запиту

```
https://airapi.airly.eu/v2/installations:id
```
Де `:id` - id локації у базі Airly.

Отримані з API дані приходять у форматі json.

_Приклад отриманих даних:_
```
{

	"current": {
		"fromDateTime": "2018-08-24T08:24:48.652Z",
		"tillDateTime": "2018-08-24T09:24:48.652Z",
		
		"values": [
			{ "name": "PM1", "value": 12.73 },
			{ "name": "PM25", "value": 18.7 },
			{ "name": "PM10", "value": 35.53 },
			{ "name": "PRESSURE", "value": 1012.62 },
			{ "name": "HUMIDITY", "value": 66.44 },
			{ "name": "TEMPERATURE", "value": 24.71 },
		],

		"indexes": [{
			"name": "AIRLY\_CAQI",
			"value": 35.53,
			"level": "LOW",
			"description": "Dobre powietrze.",
			"advice": "Możesz bez obaw wyjść na zewnątrz.",
			"color": "#D1CF1E"
		}],

		"standards": [{
			"name": "WHO",
			"pollutant": "PM25",
			"limit": 25,
			"percent": 74.81
		}],

		},

		"history": [...],

		"forecast": [...]
	}
}
```

**Підготовка даних**

Для початку зі всіх даних потрібно дістати лише ті, які потрібні для внесення в БД, тобто лише дані параметрів зчитування в датчиках. Після підготовки даних в потрібному нам форматі, вони передаються для запису в БД

**Підключення до БД**

Для підключення до БД на потрібно:

1. Ім'я бази даних
2. Ім'я користувача
3. Пароль
4. Хост сервера де знаходиться база даних
5. Порт серверу

Дані про БД знаходяться в файлі з розширенням .env.

Приклад підключення:

```
	psycopg2.connect(dbname="Ім'я бази даних", user="Ім'я користувача", password="Пароль", host="Хост сервера де знаходиться база даних", port="Порт серверу")
```

**Запис в БД**

Запис відбувається за допомогою SQL запиту в якому вказується в які дані, в яку схему та яку таблицю ці дані потрібно записати. Всі дані записуються за допомогою одного запиту для забезпечення коректної роботи БД

Приклад запиту до БД:
```
	INSERT INTO схема."таблиця"("Дані")
```
